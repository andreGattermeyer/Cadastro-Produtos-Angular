<div class="container">
  <h2>Registrar Nova Venda</h2>

  <form (ngSubmit)="onSubmit()">
    <div class="form-group">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Vendedor</mat-label>
        <mat-select [(ngModel)]="venda.vendedor.id" name="vendedor" required>
          <mat-option *ngFor="let vendedor of vendedores" [value]="vendedor.id">
            {{vendedor.nome}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="form-group">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Produto</mat-label>
        <mat-select [(ngModel)]="venda.produto.id" name="produto" required (selectionChange)="onProdutoChange()">
          <mat-option *ngFor="let produto of produtos" [value]="produto.id">
            {{produto.nomeProduto}} - Estoque: {{produto.quantidade}} - Preço: {{produto.precoVenda | currency:'BRL'}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="form-group">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Quantidade</mat-label>
        <input matInput [(ngModel)]="venda.quantidade" name="quantidade" type="number" min="1" required>
        <mat-hint *ngIf="produtoSelecionado">Disponível: {{produtoSelecionado.quantidade}}</mat-hint>
      </mat-form-field>
    </div>

    <div class="form-group">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Preço de Venda</mat-label>
        <input matInput [(ngModel)]="venda.precoVendido" name="precoVendido" type="number" min="0" required>
      </mat-form-field>
    </div>

    <div class="info-box" *ngIf="venda.quantidade > 0 && venda.precoVendido > 0">
      <p><strong>Valor Total:</strong> {{venda.quantidade * venda.precoVendido | currency:'BRL'}}</p>
    </div>

    <div class="button-group">
      <button mat-raised-button color="primary" type="submit">
        Registrar Venda
      </button>
      <button mat-raised-button [routerLink]="['/vendas']">
        Cancelar
      </button>
    </div>
  </form>
</div>
